<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>O-stats: pairwise community-level niche overlap statistics • Ostats</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="O-stats: pairwise community-level niche overlap statistics">
<meta property="og:description" content="Ostats">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Ostats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/01-Ostats-introduction.html">O-stats: pairwise community-level niche overlap statistics</a>
    </li>
    <li>
      <a href="../articles/02-Ostats-multivariate.html">Multivariate O-statistics</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>O-stats: pairwise community-level niche overlap statistics</h1>
                        <h4 class="author">Arya Yue, Quentin D. Read, Isadora Essig Fluck, Benjamin Baiser, John M. Grady, Phoebe L. Zarnetske, Sydne Record</h4>
            
            <h4 class="date">2021-04-26</h4>
      
      
      <div class="hidden name"><code>01-Ostats-introduction.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<p>The study of functional traits in ecology enables a greater understanding of the mechanisms underlying patterns of biodiversity. While trait-based research has traditionally focused on mean trait values for a species, there is a growing awareness of the need to pay greater attention to intraspecific trait variation (ITV; Violle et al. 2012). From an evolutionary standpoint, ITV is important because it reflects differences within a species on which natural selection acts, and ecologically these differences within and among species traits may give rise to differences in species interactions (Bolnick et al. 2011, Read et al. 2018).</p>
<p>When ITV is taken into account, trait values of individuals of each species may be represented as a distribution rather than as a single mean value. The degree of trait similarity between species can be measured as the amount of overlap in trait space between all species pairs in a community. Lower overlap indicates greater trait partitioning between pairs of species in a community. The Ostats package calculates a statistic to measure the degree of community-level trait overlap by fitting nonparametric kernel density functions to each species’ trait distribution and calculating their areas of overlap (Mouillot et al. 2005, Geange et al. 2011, Read et al. 2018). The median pairwise overlap for a community is calculated by first determining the overlap of each species pair in trait space, and then taking the median overlap of each species pair in a community. Functions in this package can be used to assess the level of species trait overlap and compare across communities. Effect size statistics can also be calculated against local or regional null models.</p>
<p>Note that we have written an accompanying teaching module to Read et al. (2018), which walks through a figure set exercise for the manuscript (Grady et al. 2018). This teaching module may be helpful to review for interpretation of the overlap statistics and graphs.</p>
</div>
<div id="downloading-the-ostats-package" class="section level1">
<h1 class="hasAnchor">
<a href="#downloading-the-ostats-package" class="anchor"></a>Downloading the Ostats package</h1>
<p>The Ostats package is available on Github and can be installed using the devtools package with the line of code below.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">'NEON-biodiversity/Ostats'</span><span class="op">)</span></code></pre></div>
<hr>
<p>The Ostats package can be used to do the following:</p>
<ul>
<li><p>Calculating overlap statistics against a local null model using <code>Ostats</code>. <code>Ostats</code> is capable of processing both linear (e.g., body size) and circular (e.g., time, angles) data.</p></li>
<li><p>The plotting function <code>Ostats_plot</code> is used to produce a visualization of species trait overlap in each community.</p></li>
</ul>
</div>
<div id="step-by-step-examples" class="section level1">
<h1 class="hasAnchor">
<a href="#step-by-step-examples" class="anchor"></a>Step-by-step Examples</h1>
<div id="calculating-the-overlap-statistics-for-linear-data-against-a-local-null-model" class="section level2">
<h2 class="hasAnchor">
<a href="#calculating-the-overlap-statistics-for-linear-data-against-a-local-null-model" class="anchor"></a>Calculating the overlap statistics for linear data against a local null model</h2>
<p>The function <code>Ostats</code> is the primary function in this package. This function first generates density estimates for species trait distributions and calculates the intersection of two density functions to produce pairwise overlap values. <em>Ostats</em> then calculates a community overlap value from the pairwise overlap values of all species pairs in the community. Finally, <code>Ostats</code> calculates effect sizes from a null model (z‐score) to test whether trait sorting within the bounds of trait space underlies decreased overlap, allowing the user to explore the drivers of variation in body size overlap.</p>
<div id="example-how-to-find-the-degree-of-overlap-in-body-sizes-for-all-small-mammal-species-present-in-a-particular-community-and-compare-it-with-other-communities" class="section level3">
<h3 class="hasAnchor">
<a href="#example-how-to-find-the-degree-of-overlap-in-body-sizes-for-all-small-mammal-species-present-in-a-particular-community-and-compare-it-with-other-communities" class="anchor"></a>EXAMPLE: How to find the degree of overlap in body sizes for all small mammal species present in a particular community, and compare it with other communities?</h3>
<p>The input of the function <code>Ostats</code> is taken from a dataset with a column for species identification, a column that indicates which community the individual belongs to, and a column with trait measurements, often log-transformed. The code chunk below generates an input dataset for Ostats, used to calculate the Overlap statistics for sites Harvard Forest (HARV) and Jornada (JORN) from the National Ecological Observatory Network (NEON) (Read et al., 2018). NEON is a National Science Foundation funded network of 81 terrestrial and aquatic field sites strategically located across climatic domains in the United States where standardized protocols are used to sample a variety of ecological observations including small mammal body sizes. Harvard Forest is located in the northeastnern U.S. (Massachusetts) and encompasses a temperate hardwood forest ecosystem. Jornada is located in the southwestern U.S. (New Mexico) and encompasses a desert ecosystem.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load the Ostats package. </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">Ostats</span><span class="op">)</span>

<span class="co"># Data from Read et al. (2018) included with package</span>
<span class="co"># Subset data to only two sites (Harvard and Jornada)</span>
<span class="co"># and keep only the relevant columns.</span>
<span class="co"># Add a new column named "log_weight" to log-transform the measurements.</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">small_mammal_data</span><span class="op">[</span><span class="va">small_mammal_data</span><span class="op">$</span><span class="va">siteID</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'HARV'</span>, <span class="st">'JORN'</span><span class="op">)</span>, 
                         <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'siteID'</span>, <span class="st">'taxonID'</span>, <span class="st">'weight'</span><span class="op">)</span><span class="op">]</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span>, <span class="op">]</span>
<span class="va">dat</span><span class="op">$</span><span class="va">log_weight</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span></code></pre></div>
<p>Below is a subset of the input dataset. Each row represents an individual small mammal that was trapped and weighed, with information of its local of capture (siteID), species identity (taxonID), body mass in grams and the log value of the body mass in grams. Here we show only a single row from each species at each site.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Subset the first row of each siteID and taxonID to summarize the data.</span>
<span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://rdrr.io/r/base/interaction.html">interaction</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">siteID</span>, <span class="va">dat</span><span class="op">$</span><span class="va">taxonID</span><span class="op">)</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, 
                      <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;           siteID taxonID weight log_weight</span>
<span class="co">#&gt; JORN.CHPE   JORN    CHPE   16.0  1.2041200</span>
<span class="co">#&gt; JORN.DIME   JORN    DIME   47.0  1.6720979</span>
<span class="co">#&gt; JORN.DIOR   JORN    DIOR   43.0  1.6334685</span>
<span class="co">#&gt; JORN.DISP   JORN    DISP  122.5  2.0881361</span>
<span class="co">#&gt; JORN.MUMU   JORN    MUMU   13.0  1.1139434</span>
<span class="co">#&gt; HARV.MYGA   HARV    MYGA   19.0  1.2787536</span>
<span class="co">#&gt; HARV.NAIN   HARV    NAIN   17.0  1.2304489</span>
<span class="co">#&gt; JORN.NEAL   JORN    NEAL   85.0  1.9294189</span>
<span class="co">#&gt; JORN.NEMI   JORN    NEMI  143.0  2.1553360</span>
<span class="co">#&gt; JORN.ONAR   JORN    ONAR   33.0  1.5185139</span>
<span class="co">#&gt; JORN.ONLE   JORN    ONLE   27.5  1.4393327</span>
<span class="co">#&gt; JORN.PEFA   JORN    PEFA   21.0  1.3222193</span>
<span class="co">#&gt; JORN.PEFL   JORN    PEFL    6.0  0.7781513</span>
<span class="co">#&gt; HARV.PELE   HARV    PELE   36.0  1.5563025</span>
<span class="co">#&gt; JORN.PELE   JORN    PELE   39.0  1.5910646</span>
<span class="co">#&gt; HARV.PEMA   HARV    PEMA   23.5  1.3710679</span>
<span class="co">#&gt; HARV.PEME   HARV    PEME   23.0  1.3617278</span>
<span class="co">#&gt; HARV.PESP   HARV    PESP   29.0  1.4623980</span>
<span class="co">#&gt; JORN.PGSP   JORN    PGSP   14.0  1.1461280</span>
<span class="co">#&gt; JORN.SIHI   JORN    SIHI  170.0  2.2304489</span></code></pre></div>
</div>
<div id="arguments-to-ostats" class="section level3">
<h3 class="hasAnchor">
<a href="#arguments-to-ostats" class="anchor"></a>Arguments to Ostats()</h3>
<p>In the below example, all arguments are set to their default values.</p>
<p>To explore the drivers of variation in body size overlap, <code>Ostats</code> can implement a null model to test whether individual species’ body size distributions are more evenly spaced along the trait axis than expected by chance. This approach evaluates the z‐score of each observed community against the distribution of a user defined number of null communities. In these null communities, species body size means may be shuffled randomly, retaining the shape and width of the distribution around the mean for each species.</p>
<ul>
<li><p>The argument <code>data_type</code> has a default value of <code>"linear"</code>, as the data processed are one dimensional (i.e., body masses of individual small mammals). The alternative input for this argument is <code>"circular"</code> for data that are periodic (e.g., measured in radians or degrees).</p></li>
<li><p>The argument <code>output</code> specifies whether the median or mean of all pairwise overlap values between distributions of species will be returned. The default value for output is <code>"median"</code>. The choice between median and mean for the output will depend on the variability in the input data and it is a good idea to see how much this choice influences the results of the analysis. For examples of analyses using the median and mean, respectively, see Read et al. 2018 and Mouillot et al. 2015.</p></li>
<li><p>The <code>weight_type</code> argument specifies whether or not the abundances of each species within a community will be used to calculate the median or mean output returned by the Ostats function. Using the default value <code>"hmean"</code>, the function weights the pairwise overlaps of trait distributions of each pair of species in each community as <code>2/(1/abundance_a + 1/abundance_b)</code>, where <code>abundance_a</code> and <code>abundance_b</code> are the numeric abundances of each species in the pair. The harmonic mean <code>weight_type</code> is set as the default as it minimizes the effect of outliers and rare species. If the argument <code>weight_type = "none"</code>, no weights are used for the calculation of mean or median. If <code>weight_type = "mean"</code>, raw abundances of species are used as weights.</p></li>
<li><p>The argument <code>nperm</code> sets the number of permutations, or randomly generated data null community subsets, for the null model. The default number of permutations is <code>99</code>. The argument <code>nullqs</code> sets the quantile limits for effect size statistics calculation. This argument should be a length-2 numeric vector of probabilities with values between zero and one. The default lower and upper effect size quantiles, respectively, are <code>0.025</code> and <code>0.975.</code></p></li>
<li><p>The <code>shuffle_weights</code> and <code>swap_means</code> arguments allow the user to modify the implementation of the null models. At default, <code>shuffle_weights = FALSE</code> and <code>swap_means = FALSE</code>, and the null model is generated by randomly assigning a taxon that is present in the community to each individual. To change the way the null model is generated, the user can make use of these two arguments. If <code>shuffle_weights = TRUE</code>, the <code>Ostats</code> function shuffles weights given to pairwise overlaps within a community when generating null models. If <code>swap_means = TRUE</code>, the means of body sizes are randomly assigned to species within a community.</p></li>
<li><p><code>density_args</code> is an argument for the user to add any additional arguments to pass to <code><a href="https://rdrr.io/r/stats/density.html">stats::density</a></code>, such as <code>bw</code>, <code>n</code>, or <code>adjust</code>. If none are provided, default values are used (i.e., <code>bw = "nrd0"</code>, a<code>djust = 1</code>, and <code>n = 512</code>, where <code>bw</code> is the smoothing bandwidth to be used, <code>adjust</code> is a numeric value the bandwidth is multiplied by to get the actual bandwidth implemented by the <em>density</em> function, and <code>n</code> is the number of equally spaced points at which the density is to be estimated).</p></li>
</ul>
<p>Running the function may take several minutes, depending on the size of the dataset and the null model generation. A progress bar is provided to help the user monitor the time until the function completes the job. Note that in the code chunk below, the ‘traits’ argument is defined as a matrix with one column and as many rows as there are individuals in the dataset. The ‘sp’ and ‘plots’ arguments are each vectors of length number of individuals in the dataset where all elements are specified as factors. In this example, since the data are body sizes as measured by mass in grams, the data are considered linear for the argument <code>data_type</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Run O-stats on the small mammal data with all arguments set to default</span>
 <span class="va">Ostats_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Ostats.html">Ostats</a></span><span class="op">(</span>traits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>,<span class="st">'log_weight'</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span>,
                    sp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">taxonID</span><span class="op">)</span>,
                    plots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">siteID</span><span class="op">)</span>,
                    data_type <span class="op">=</span> <span class="st">"linear"</span>,
                    random_seed <span class="op">=</span> <span class="fl">517</span><span class="op">)</span>
<span class="co">#&gt; Note: species abundances differ. Consider sampling equivalent numbers of individuals per species.</span></code></pre></div>
<p>The below code chunk shows an example of how the <code>density_args</code> inputs could be changed if so desired:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Example of specifying the arguments for making density estimates</span>
<span class="va">Ostats_example2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Ostats.html">Ostats</a></span><span class="op">(</span>traits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>,<span class="st">'log_weight'</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span>,
                    sp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">taxonID</span><span class="op">)</span>,
                    plots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">siteID</span><span class="op">)</span>, 
                    density_args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>bw <span class="op">=</span> <span class="st">'nrd0'</span>, adjust <span class="op">=</span> <span class="fl">2</span>, n<span class="op">=</span><span class="fl">200</span><span class="op">)</span>,
                    random_seed <span class="op">=</span> <span class="fl">518</span><span class="op">)</span></code></pre></div>
<p>The result of <code>Ostats</code> is a list containing four items. The first item in the list is <code>overlaps_norm</code>, a matrix with one column and the number of rows equal to the number of communities showing community overlap values for each community with the area under all density functions normalized to 1.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># View overlaps_norm</span>
<span class="va">Ostats_example</span><span class="op">$</span><span class="va">overlaps_norm</span>
<span class="co">#&gt;      log_weight</span>
<span class="co">#&gt; HARV 0.89451637</span>
<span class="co">#&gt; JORN 0.01866901</span></code></pre></div>
<p>The second item in the list resulting from running the <code>Ostats</code> function is <code>overlaps_unnorm</code>, a matrix with one column and the number of rows equal to the number of communities showing community overlap values for each community with the area under all density functions proportional to the number of observations in that group.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># View overlaps_unnorm</span>
<span class="va">Ostats_example</span><span class="op">$</span><span class="va">overlaps_unnorm</span>
<span class="co">#&gt;      log_weight</span>
<span class="co">#&gt; HARV 0.65998968</span>
<span class="co">#&gt; JORN 0.01024091</span></code></pre></div>
<p>Elements in the <code>overlaps_norm</code> and <code>overlaps_unnorm</code> matrices are overlap values for each community, where one indicates complete overlap and zero indicates no overlap between species pairs within the community. A higher overlap value means greater similarity among species trait distributions. The difference between <code>overlaps_norm</code> and <code>overlaps_unnorm</code> is that <code>overlaps_norm</code> does not take species abundance into account to show relative differences between species across communities. Harvard Forest (HARV) has a high community overlap value indicating greater similarity among species trait distributions, whereas Jornada (JORN) has a very low community overlap value indicating low similarity in species trait distributions. These results are consistent across both <code>overlaps_norm</code> and <code>overlaps_unnorm</code>.</p>
<p>The last two items in the list generated by <code>Ostats</code> contain the effect size statistics from the null models. The third and fourth items in the list are <code>overlaps_norm_ses</code> and <code>overlaps_unnorm_ses</code>, which each consist of five matrices of effect size statistics against a null model. The difference between these two final items are that in <code>overlaps_norm_ses</code> the area under all density functions is normalized to 1, whereas in <code>overlaps_unnorm_ses</code> the area under all density functions is proportional to the number of observations per community. The code below displays the outputs of these third and fourth items:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># View normalized and non-normalized standardized effect size outputs from null model analysis</span>
<span class="va">Ostats_example</span><span class="op">$</span><span class="va">overlaps_norm_ses</span>
<span class="co">#&gt; $ses</span>
<span class="co">#&gt;       log_weight</span>
<span class="co">#&gt; HARV  -0.8434786</span>
<span class="co">#&gt; JORN -47.7570228</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ses_lower</span>
<span class="co">#&gt;      log_weight</span>
<span class="co">#&gt; HARV  -2.426371</span>
<span class="co">#&gt; JORN  -2.072424</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ses_upper</span>
<span class="co">#&gt;      log_weight</span>
<span class="co">#&gt; HARV   1.595012</span>
<span class="co">#&gt; JORN   1.720237</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $raw_lower</span>
<span class="co">#&gt;      log_weight</span>
<span class="co">#&gt; HARV  0.8612621</span>
<span class="co">#&gt; JORN  0.8372998</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $raw_upper</span>
<span class="co">#&gt;      log_weight</span>
<span class="co">#&gt; HARV  0.9457456</span>
<span class="co">#&gt; JORN  0.9052612</span>
<span class="va">Ostats_example</span><span class="op">$</span><span class="va">overlaps_unnorm_ses</span>
<span class="co">#&gt; $ses</span>
<span class="co">#&gt;       log_weight</span>
<span class="co">#&gt; HARV  -0.7095416</span>
<span class="co">#&gt; JORN -69.8210213</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ses_lower</span>
<span class="co">#&gt;      log_weight</span>
<span class="co">#&gt; HARV  -2.599491</span>
<span class="co">#&gt; JORN  -3.740130</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ses_upper</span>
<span class="co">#&gt;      log_weight</span>
<span class="co">#&gt; HARV  0.9541984</span>
<span class="co">#&gt; JORN  1.1318384</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $raw_lower</span>
<span class="co">#&gt;      log_weight</span>
<span class="co">#&gt; HARV  0.6511992</span>
<span class="co">#&gt; JORN  0.4750262</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $raw_upper</span>
<span class="co">#&gt;      log_weight</span>
<span class="co">#&gt; HARV  0.6677280</span>
<span class="co">#&gt; JORN  0.5092935</span></code></pre></div>
<p>These effect size values are used to compare the observed overlap statistics with a local null model (z-score test). As aforementioned, the upper and lower limits are set at 95% by default. If the ses (standard effect sizes) value is lower than the lower limit for that community, it suggests that the community overlap value observed is lower than expected by chance from a null model. Similarly, if the community overlap value is higher than the upper limit, the community has a higher overlap than expected by chance. In this example, regardless of whether normalized or non-normalized values are calculated, the community overlap of Harvard Forest (HARV) falls within the upper and lower quantiles, suggesting that the overlap value at HARV is not significantly different from the overlap values calculated from randomly generated community trait distributions. On the other hand, Jornarda (JORN) has a much lower value than the lower ses quantile limit, suggesting that JORN small mammal body size distributions are less similar than expected by chance based on the null models.</p>
</div>
</div>
<div id="overlap-statistics-for-circular-data-against-a-local-null-model" class="section level2">
<h2 class="hasAnchor">
<a href="#overlap-statistics-for-circular-data-against-a-local-null-model" class="anchor"></a>Overlap statistics for circular data against a local null model</h2>
<p><code>Ostats</code> can also be used to calculate overlap statistics of circular data, such as angular data (e.g., direction and orientation) or time. Two different kinds of circular calculations are available: continuous and discrete. To specify a circular analysis, set the argument <code>data_type = "circular"</code> if the data are circular and continuous, or set <code>data_type = "circular_discrete"</code> if the data are circular and discrete (i.e., collected every hour).</p>
<div id="example-how-to-find-the-degree-of-overlap-in-time-occurences-for-ant-species-present-in-a-chamber-and-compare-across-chambers-of-different-conditions" class="section level3">
<h3 class="hasAnchor">
<a href="#example-how-to-find-the-degree-of-overlap-in-time-occurences-for-ant-species-present-in-a-chamber-and-compare-across-chambers-of-different-conditions" class="anchor"></a>EXAMPLE: How to find the degree of overlap in time occurences for ant species present in a chamber, and compare across chambers of different conditions?</h3>
<p>To illustrate the calculation of overlap statistics applied to discrete, circular data the <code>Ostats</code> package provides a sample dataset called <code>ant_data</code>. This is a subset of the data analysed in Stuble et al. (2014), wherein ant communities were exposed to chambers with different air temperatures to explore the effects of increased temperature on seed dispersal by ants. The <code>ant_data</code> dataframe consists of three columns: 1) species (given as genus and species with a space between the two names), 2) chamber (i.e., 1 or 2), and 3) time (numeric data ranging from 0-23 to represent the 24 hours in a day).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Take a look at the first six rows of the ant data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ant_data</span><span class="op">)</span>
<span class="co">#&gt;                   species chamber time</span>
<span class="co">#&gt; 1    Camponotus castaneus       1    0</span>
<span class="co">#&gt; 2    Camponotus castaneus       1    0</span>
<span class="co">#&gt; 3    Camponotus castaneus       1    0</span>
<span class="co">#&gt; 4    Camponotus castaneus       1    0</span>
<span class="co">#&gt; 5 Crematogaster lineolata       1    0</span>
<span class="co">#&gt; 6 Crematogaster lineolata       1    0</span></code></pre></div>
<p>The arguments are the same as in the linear data calculation. In the example below with <code>ant_data</code>, the input data are a record of ants in two chambers and their hourof occurrence. For ant_data that contains circular discrete time, we specify <code>“circular_discrete”</code> for the <code>data_type</code> argument. However, for continuous circular data, <code>data_type = "circular"</code> is used. We specify the argument <code>unique_values</code> to tabulate the density at all possible discrete values that the time of occurrence can take. In this case there are 24 possible values, <code>0:23</code>. Finally, <code>circular_args</code> can be used to pass additional arguments to the underlying function <code><a href="https://rdrr.io/pkg/circular/man/circular.html">circular::circular</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Calculate overlap statistics for hourly data using the ant_data dataset</span>
<span class="va">circular_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Ostats.html">Ostats</a></span><span class="op">(</span>traits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">ant_data</span><span class="op">[</span>, <span class="st">'time'</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span>,
                    sp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">ant_data</span><span class="op">$</span><span class="va">species</span><span class="op">)</span>,
                    plots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">ant_data</span><span class="op">$</span><span class="va">chamber</span><span class="op">)</span>,
                    data_type <span class="op">=</span> <span class="st">"circular_discrete"</span>,
                    unique_values <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">23</span>,
                    random_seed <span class="op">=</span> <span class="fl">519</span><span class="op">)</span>
<span class="co">#&gt; Note: species abundances differ. Consider sampling equivalent numbers of individuals per species.</span></code></pre></div>
<p>The output is the same as in the linear data calculation. The code below shows the normalized and non-normalized overlap values for the two chambers, respectively, in the first four lines followed by the standardized effect sizes from the null models.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># View overlaps_norm</span>
<span class="va">circular_example</span><span class="op">$</span><span class="va">overlaps_norm</span>
<span class="co">#&gt;        time</span>
<span class="co">#&gt; 1 0.6833794</span>
<span class="co">#&gt; 2 0.6363885</span>
<span class="co"># View overlaps_unnorm</span>
<span class="va">circular_example</span><span class="op">$</span><span class="va">overlaps_unnorm</span>
<span class="co">#&gt;        time</span>
<span class="co">#&gt; 1 0.5319838</span>
<span class="co">#&gt; 2 0.4864958</span>
<span class="co">#View normalized standardized effect size outputs from null model analysis</span>
<span class="va">circular_example</span><span class="op">$</span><span class="va">overlaps_norm_ses</span>
<span class="co">#&gt; $ses</span>
<span class="co">#&gt;        time</span>
<span class="co">#&gt; 1 -17.48156</span>
<span class="co">#&gt; 2 -20.35080</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ses_lower</span>
<span class="co">#&gt;        time</span>
<span class="co">#&gt; 1 -1.664181</span>
<span class="co">#&gt; 2 -2.104153</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ses_upper</span>
<span class="co">#&gt;       time</span>
<span class="co">#&gt; 1 2.071737</span>
<span class="co">#&gt; 2 1.661167</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $raw_lower</span>
<span class="co">#&gt;        time</span>
<span class="co">#&gt; 1 0.8689374</span>
<span class="co">#&gt; 2 0.8613604</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $raw_upper</span>
<span class="co">#&gt;        time</span>
<span class="co">#&gt; 1 0.9127644</span>
<span class="co">#&gt; 2 0.9077849</span>
<span class="co">#View non-normalized standardized effect size outputs from null model analysis</span>
<span class="va">circular_example</span><span class="op">$</span><span class="va">overlaps_unnorm_ses</span>
<span class="co">#&gt; $ses</span>
<span class="co">#&gt;        time</span>
<span class="co">#&gt; 1 -5.728487</span>
<span class="co">#&gt; 2 -3.082192</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ses_lower</span>
<span class="co">#&gt;        time</span>
<span class="co">#&gt; 1 -1.652025</span>
<span class="co">#&gt; 2 -1.651042</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ses_upper</span>
<span class="co">#&gt;       time</span>
<span class="co">#&gt; 1 1.837294</span>
<span class="co">#&gt; 2 1.950886</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $raw_lower</span>
<span class="co">#&gt;        time</span>
<span class="co">#&gt; 1 0.5452298</span>
<span class="co">#&gt; 2 0.4914410</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $raw_upper</span>
<span class="co">#&gt;        time</span>
<span class="co">#&gt; 1 0.5565680</span>
<span class="co">#&gt; 2 0.5038871</span></code></pre></div>
<p>Regardless of whether the normalized or non-normalized overlap values are considered, the amount of overlap for both chambers is neither very high nor very low. For both chamber communities, the <code>ses</code> value is lower than the lower limit for each community, suggesting that the community overlap values observed for each chamber are lower than expected by chance from a null model, regardless of whether normalized or non-normalized ses values are considered.</p>
</div>
</div>
<div id="overlap-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#overlap-plots" class="anchor"></a>Overlap plots</h2>
<p>The graphing function <code>Ostats_plot</code> depends on <code>ggplot2</code> and can be used to graph species trait overlaps of each community for multiple communities.</p>
<p>The input dataset needs to have these information: * <code>plots</code> community or site identity: a vector of names to indicate which community or site the individual belongs to. * <code>sp</code> taxon identification: a vector of species or taxa names. * <code>traits</code> trait measurements: a vector of trait measurements for each individual, or a matrix with rows representing individuals and columns representing traits. * <code>overlap_dat</code> This input information is optional. It is an object containing the output of <code>Ostats</code> for the same data. If provided, it is used to label the plot panels with the community overlap values.</p>
<p>There are various arguments to fine tune the plot you produce:</p>
<ul>
<li><p>The argument <code>n_col</code> can be used to change number of columns for layout of individual panels. The default is 1.</p></li>
<li><p><code>use_plots</code> is a vector to specify which sites to plot. If NULL, the function will plot all the sites/communities. Note that if you try to plot too many communities at once, then the contents of the plots become difficult to see.</p></li>
<li><p><code>colorvalues</code> is a vector of color values for the density polygons. This argument defaults to a viridis palette if no other is provided. It is recommended that the number of colors be equal to the number of taxa in the community to ensure that the same color is not repeated for different taxa.</p></li>
<li><p><code>alpha</code> defines the transparency level for colors that fill the density polygons with the default being 0.5.</p></li>
<li><p><code>adjust</code> is a value that is multiplied by the bandwidth adjustment of the density curves. The smaller this value is, the smaller the density polygons will be. The default is 2. See <code><a href="https://rdrr.io/r/stats/density.html">stats::density</a></code>.</p></li>
<li><p><code>limits_x</code> a vector of length 2: it sets the limits (min and max values) of the x-axis. The default x-axis limits are: a minimum of 0.5 times the minimum observed trait measurement (with <code>NA</code>s removed) and a maximum of 1.5 times the maximum observed trait measurement. Or in other words: <code><a href="https://rdrr.io/r/base/c.html">c(0.5*min(trait,na.rm=TRUE), 1.5*max(trait,na.rm=TRUE))</a></code>.</p></li>
<li><p><code>scale</code> If you want the scale of x, y or both x and y axis to be adjusted according to each site density probability set the argument to <code>"free_x"</code>, <code>"free_y"</code> or <code>"free"</code> respectively. Default = <code>"fixed"</code> which uses the same scale across all sites. See <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">ggplot2::facet_grid</a></code>.</p></li>
<li><p><code>name_x</code> is a character string indicating the name of the x-axis (i.e., the name of the trait) with a default of <code>'trait value'</code>.</p></li>
<li><p><code>name_y</code> is a character string indicating the name of the y-axis with a default of <code>'Probability Density'</code>.</p></li>
<li><p><code>means</code> is a logical variable. If set <code>FALSE</code>, which is the default value, then a single column of graphs is generated that illustrates the trait probability density curves for each species. If set to <code>TRUE</code>, then graphs of mean trait values are plotted in a second column for comparison of means with trait density curves. Note that setting means to <code>TRUE</code> is only recommended when you are plotting a few illustrative sites. If too many sites are plotted with mean set to <code>TRUE</code> then the graphs become small and difficult to read.</p></li>
</ul>
<p>The following example plots the NEON small mammal data.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Set the arguments:</span>
<span class="va">siteID</span> <span class="op">&lt;-</span> <span class="va">small_mammal_data</span><span class="op">$</span><span class="va">siteID</span>
<span class="va">taxonID</span> <span class="op">&lt;-</span> <span class="va">small_mammal_data</span><span class="op">$</span><span class="va">taxonID</span>
<span class="va">trait</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">small_mammal_data</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span>

<span class="co"># To plot only selected sites:</span>
<span class="va">sites2use</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'HARV'</span>,<span class="st">'JORN'</span><span class="op">)</span> 

<span class="fu"><a href="../reference/Ostats_plot.html">Ostats_plot</a></span><span class="op">(</span>plots <span class="op">=</span> <span class="va">siteID</span>, 
            sp <span class="op">=</span> <span class="va">taxonID</span>, 
            traits <span class="op">=</span> <span class="va">trait</span>, 
            overlap_dat <span class="op">=</span> <span class="va">small_mammal_Ostats</span>, 
            use_plots <span class="op">=</span> <span class="va">sites2use</span>, 
            name_x <span class="op">=</span> <span class="st">'log10 Body Weight (g)'</span>, 
            means <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="01-Ostats-introduction_files/figure-html/unnamed-chunk-13-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>The graphs to the left show the intraspecific trait variation as illustrated by density curves, and the graphs to the right show mean trait values. For all graphs probability density is shown on the y-axis and log-transformed body weight on the x-axis. Each color represents a different species and colors are consistent across graphs. The top row illustrates trait values for HARV (Harvard Forest), whereas the bottom row illustrates trait values for JORN (Jornada). The left column of graphs also show the median overlap value for the entire community. Note that there is more overlap in body weight values for HARV than for JORN.</p>
<p>Note that currently there is no functionality within the <code>Ostats</code> package to graph the outputs of <code>Ostats</code> when it is applied to circular data.</p>
</div>
</div>
<div id="bibliography" class="section level1">
<h1 class="hasAnchor">
<a href="#bibliography" class="anchor"></a>Bibliography</h1>
<p>Bolnick, D.I., P. Amarasekare, M.S. Araujo, R. Burger, J.M. Levine, M. Novak, V.H.W. Rudolf, S.J. Schreiber, M.C. Urban, and D.A. Vasseur. 2011. Why intraspecific trait variation matters in ecology. <em>Trends in Ecology and Evolution</em> 26(4):183-192. <a href="https://doi.org/10.1016/j.tree.2011.01.009" class="uri">https://doi.org/10.1016/j.tree.2011.01.009</a></p>
<p>Geange, S.W., S. Pledger, K.C. Burns, and J.S. Shima. 2011. A unified analysis of niche overlap incorporating data of different types. <em>Methods in Ecology and Evolution</em> 2(2):175-184. <a href="https://doi.org/10.1111/j.2041-210X.2010.00070.x" class="uri">https://doi.org/10.1111/j.2041-210X.2010.00070.x</a></p>
<p>Grady, J.M., Q.D. Read, S. Record, P.L. Zarnetske, B. Baiser, K. Thorne, and J. Belmaker. 2018. Size, niches, and the latitudinal diversity gradient. <em>Teaching Issues and Experiments in Ecology</em> 14: Figure Set #1.</p>
<p>Mouillot, D., W. Stubbs, M. Faure, O. Dumay, J.A. Tomasini, J.B. Wilson, and T. Do Chi. 2005. Niche overlap estimated based on quantitative functional traits: A new family of non-parametric indices. <em>Oecologia</em> 145(3):345-353. <a href="https://doi.org/10.1007/s00442-005-0151-z" class="uri">https://doi.org/10.1007/s00442-005-0151-z</a></p>
<p>Read, Q.D., J.M. Grady, P.L. Zarnetske, S. Record, B. Baiser, J. Belmaker, M.-N. Tuanmu, A. Strecker, L. Beaudrot, and K.M. Thibault. 2018. Among-species overlap in rodent body size distributions predicts species richness along a temperature gradient. <em>Ecography</em> 41(10):1718–1727. <a href="https://doi.org/10.1111/ecog.03641" class="uri">https://doi.org/10.1111/ecog.03641</a></p>
<p>Stuble, K.L., C.M. Patterson, M.A. Rodriguez-Cabal, R.R. Ribbons, R.R. Dunn, and N.J. Sanders. 2014. Ant-mediated seed dispersal in a warmed world. <em>PeerJ</em> 2:e286.</p>
<p>Violle, C., B.J. Enquist, B.J. McGill, L. Jiang, C.H. Albert, C. Hulshof, V. Jung, and J. Messier. 2012. The return of the variance: Intraspecific variability in community ecology. <em>Trends in Ecology &amp; Evolution</em> 27(4):244–252. <a href="https://doi.org/10.1016/j.tree.2011.11.014" class="uri">https://doi.org/10.1016/j.tree.2011.11.014</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Quentin D. Read, Arya Yue, Isadora E. Fluck, Benjamin Baiser, John M. Grady, Phoebe L. Zarnetske, Sydne Record.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
