<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multivariate O-statistics • Ostats</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Multivariate O-statistics">
<meta property="og:description" content="Ostats">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Ostats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Ostats-introduction.html">O-stats: pairwise community-level niche overlap statistics</a>
    </li>
    <li>
      <a href="../articles/Ostats-multivariate.html">Multivariate O-statistics</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Multivariate O-statistics</h1>
                        <h4 class="author">Quentin D. Read, (INSERT OTHER AUTHORS)</h4>
            
      
      
      <div class="hidden name"><code>Ostats-multivariate.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">Ostats</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">pitcher_traits</span><span class="op">)</span></code></pre></div>
<div id="notes" class="section level1">
<h1 class="hasAnchor">
<a href="#notes" class="anchor"></a>Notes</h1>
<ul>
<li>Remove this section in the final version.</li>
<li>Authors of this doc aren’t necessarily all package authors, just those who specifically contributed to this vignette.</li>
<li>Outline of the vignette:
<ul>
<li>Explain multivariate O-stats, using hypervolumes</li>
<li>Show a “toy” version of the pitcher plant dataset</li>
<li>Run a few different variants of multivariate O-stats on them</li>
<li>Create some plots</li>
</ul>
</li>
</ul>
</div>
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<p>This vignette is intended for users who are already familiar with the single-variable O-statistics we introduce in the first package vignette (LINK TO IT).</p>
<ul>
<li>Hutchinson: niche is n-dimensional hypervolume</li>
<li>trait ecologists are interested in tradeoffs among traits or interactions among multiple traits</li>
<li>the underlying math and theory here were worked out by Blonder et al.</li>
<li>Functions from their hypervolume package are used in Ostats</li>
</ul>
</div>
<div id="example-dataset" class="section level1">
<h1 class="hasAnchor">
<a href="#example-dataset" class="anchor"></a>Example dataset</h1>
<ul>
<li>Pitcher plant traits, morphological measurements taken from sites around North America</li>
<li>Specific site locations have been removed</li>
<li>Univariate plots of pitcher traits (distributions)</li>
</ul>
<p>Here we show a few randomly selected rows from the pitcher traits dataset. Here, all individuals are of the same species. Therefore we will use populations (sites) as the <code>sp</code> variable in our analysis, with a single value for <code>plots</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">pitcher_traits</span><span class="op">)</span>, <span class="fl">10</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">pitcher_traits</span><span class="op">[</span><span class="va">idx</span>,<span class="op">]</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="left">site_id</th>
<th align="left">plant_id</th>
<th align="right">rosette_diameter_1</th>
<th align="right">rosette_diameter_2</th>
<th align="right">pitcher_length</th>
<th align="right">pitcher_width</th>
<th align="right">keel_width</th>
<th align="right">mouth_diameter</th>
<th align="right">lip_thickness</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>129</td>
<td align="left">S</td>
<td align="left">1</td>
<td align="right">26.5</td>
<td align="right">19.5</td>
<td align="right">16.5</td>
<td align="right">35.48</td>
<td align="right">18.00</td>
<td align="right">18.00</td>
<td align="right">1.15</td>
</tr>
<tr class="even">
<td>187</td>
<td align="left">CRA</td>
<td align="left">11</td>
<td align="right">28.5</td>
<td align="right">33.5</td>
<td align="right">26.2</td>
<td align="right">70.55</td>
<td align="right">34.35</td>
<td align="right">35.40</td>
<td align="right">2.33</td>
</tr>
<tr class="odd">
<td>270</td>
<td align="left">HAR</td>
<td align="left">22</td>
<td align="right">14.5</td>
<td align="right">10.0</td>
<td align="right">15.0</td>
<td align="right">37.38</td>
<td align="right">20.05</td>
<td align="right">16.57</td>
<td align="right">1.42</td>
</tr>
<tr class="even">
<td>277</td>
<td align="left">SAC</td>
<td align="left">5</td>
<td align="right">15.0</td>
<td align="right">4.5</td>
<td align="right">13.0</td>
<td align="right">46.36</td>
<td align="right">14.23</td>
<td align="right">24.86</td>
<td align="right">2.55</td>
</tr>
<tr class="odd">
<td>299</td>
<td align="left">SPR</td>
<td align="left">3</td>
<td align="right">36.5</td>
<td align="right">34.0</td>
<td align="right">23.6</td>
<td align="right">47.23</td>
<td align="right">20.71</td>
<td align="right">23.22</td>
<td align="right">1.49</td>
</tr>
<tr class="even">
<td>307</td>
<td align="left">SPR</td>
<td align="left">11</td>
<td align="right">10.0</td>
<td align="right">3.0</td>
<td align="right">16.3</td>
<td align="right">23.86</td>
<td align="right">13.67</td>
<td align="right">13.40</td>
<td align="right">1.03</td>
</tr>
<tr class="odd">
<td>471</td>
<td align="left">WOO</td>
<td align="left">8</td>
<td align="right">18.5</td>
<td align="right">16.0</td>
<td align="right">17.0</td>
<td align="right">44.16</td>
<td align="right">13.48</td>
<td align="right">26.92</td>
<td align="right">1.39</td>
</tr>
<tr class="even">
<td>509</td>
<td align="left">JON</td>
<td align="left">8</td>
<td align="right">32.0</td>
<td align="right">20.5</td>
<td align="right">22.4</td>
<td align="right">42.50</td>
<td align="right">12.42</td>
<td align="right">27.10</td>
<td align="right">2.36</td>
</tr>
<tr class="odd">
<td>597</td>
<td align="left">FOI</td>
<td align="left">19</td>
<td align="right">16.5</td>
<td align="right">16.0</td>
<td align="right">11.8</td>
<td align="right">29.60</td>
<td align="right">10.14</td>
<td align="right">15.60</td>
<td align="right">1.18</td>
</tr>
<tr class="even">
<td>679</td>
<td align="left">CAS</td>
<td align="left">5</td>
<td align="right">8.5</td>
<td align="right">11.5</td>
<td align="right">13.5</td>
<td align="right">37.36</td>
<td align="right">11.58</td>
<td align="right">19.82</td>
<td align="right">9.82</td>
</tr>
</tbody>
</table>
<p>For a more manageable example, let’s select 6 sites.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'COL'</span>, <span class="st">'CRI'</span>, <span class="st">'FLK'</span>, <span class="st">'FRA'</span>, <span class="st">'MYR'</span>, <span class="st">'SAC'</span><span class="op">)</span>
<span class="va">pitcher_traits</span> <span class="op">&lt;-</span> <span class="va">pitcher_traits</span><span class="op">[</span><span class="va">pitcher_traits</span><span class="op">$</span><span class="va">site_id</span> <span class="op">%in%</span> <span class="va">sites</span>, <span class="op">]</span></code></pre></div>
</div>
<div id="calculating-hypervolume-o-statistics" class="section level1">
<h1 class="hasAnchor">
<a href="#calculating-hypervolume-o-statistics" class="anchor"></a>Calculating hypervolume O-statistics</h1>
<ul>
<li>Calculate ostats multivariate</li>
<li>Do a couple different versions with different arguments passed to hypervolume() to demonstrate the sensitivity of results to those args</li>
</ul>
<p>Here we calculate the univariate O-statistics for each of the pitcher traits separately, then a single multivariate O-statistic representing overlap of the trait hypervolumes.</p>
<p>We will use four morphological ratios as traits to remove size-dependence: the ratios of pitcher length, keel width, mouth diameter, and lip thickness to pitcher width.</p>
<p>First ensure that the data are in the appropriate form for <code><a href="../reference/Ostats.html">Ostats()</a></code> and <code><a href="../reference/Ostats_multivariate.html">Ostats_multivariate()</a></code>. For this example we will remove individuals with incomplete data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pitcher_traits</span> <span class="op">&lt;-</span> <span class="va">pitcher_traits</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">pitcher_traits</span><span class="op">)</span>, <span class="op">]</span>

<span class="va">pitcher_sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">pitcher_traits</span><span class="op">$</span><span class="va">site_id</span><span class="op">)</span>

<span class="va">pitcher_trait_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">pitcher_traits</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'pitcher_length'</span>, <span class="st">'keel_width'</span>, <span class="st">'mouth_diameter'</span>, <span class="st">'lip_thickness'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>

<span class="va">pitcher_trait_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sweep.html">sweep</a></span><span class="op">(</span><span class="va">pitcher_trait_matrix</span>, <span class="fl">1</span>, <span class="va">pitcher_traits</span><span class="op">$</span><span class="va">pitcher_width</span>, <span class="va">`/`</span><span class="op">)</span></code></pre></div>
<p>The traits are all on a ratio scale but we should center and scale all the columns to ensure that the hypervolume overlap statistic is not influenced by different magnitudes of each trait.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">pitcher_trait_matrix</span>, <span class="fl">2</span>, <span class="va">range</span><span class="op">)</span>
<span class="co">#&gt;      pitcher_length keel_width mouth_diameter lip_thickness</span>
<span class="co">#&gt; [1,]      0.2637087  0.1876122      0.1870417     0.0103602</span>
<span class="co">#&gt; [2,]      0.6829657  0.8862120      1.0376402     0.1467974</span>

<span class="va">pitcher_trait_matrix_scaled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">pitcher_trait_matrix</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">pitcher_trait_matrix_scaled</span>, <span class="fl">2</span>, <span class="va">range</span><span class="op">)</span>
<span class="co">#&gt;      pitcher_length keel_width mouth_diameter lip_thickness</span>
<span class="co">#&gt; [1,]      -1.605260  -1.580645      -2.465757     -1.680880</span>
<span class="co">#&gt; [2,]       2.913918   3.965837       3.147183      2.813094</span></code></pre></div>
<p>Next calculate the univariate O-statistics for each of the four traits. <strong>Currently in the example we will not use null model, but eventually it should.</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pitcher_univariate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Ostats.html">Ostats</a></span><span class="op">(</span>traits <span class="op">=</span> <span class="va">pitcher_trait_matrix_scaled</span>,
                             plots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">pitcher_trait_matrix_scaled</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                             sp <span class="op">=</span> <span class="va">pitcher_sites</span>,
                             random_seed <span class="op">=</span> <span class="fl">444</span>,
                             run_null_model <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
<p>Now calculate the multivariate O-statistic for the traits combined, using all default arguments. The <code>random_seed</code> is still used even in the absence of a null model because the hypervolumes are constructed with a stochastic algorithm.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pitcher_multivariate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Ostats_multivariate.html">Ostats_multivariate</a></span><span class="op">(</span>traits <span class="op">=</span> <span class="va">pitcher_trait_matrix_scaled</span>,
                                            plots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">pitcher_trait_matrix_scaled</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                                            sp <span class="op">=</span> <span class="va">pitcher_sites</span>,
                                            random_seed <span class="op">=</span> <span class="fl">333</span>,
                                            run_null_model <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
<p>Compare the univariate and multivariate O-statistics.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pitcher_univariate</span><span class="op">$</span><span class="va">overlaps_norm</span>
<span class="co">#&gt;   pitcher_length keel_width mouth_diameter lip_thickness</span>
<span class="co">#&gt; 1      0.5421116  0.6614894      0.4668562     0.4324875</span>

<span class="va">pitcher_multivariate</span><span class="op">$</span><span class="va">overlaps_norm</span>
<span class="co">#&gt;        [,1]</span>
<span class="co">#&gt; 1 0.6548594</span></code></pre></div>
<p>The single multivariate O-statistic is not comparable to the univariate statistics because of differing dimensionality. Therefore we need to evaluate them against null models.</p>
<p><strong>Here run the multivariate O-stats with different args to hypervolume, and with null models</strong></p>
</div>
<div id="visualizing-hypervolume-o-statistics" class="section level1">
<h1 class="hasAnchor">
<a href="#visualizing-hypervolume-o-statistics" class="anchor"></a>Visualizing hypervolume O-statistics</h1>
<ul>
<li>Show the ostats multivariate plot function</li>
<li>Show a couple different plots to illustrate the effects of different arguments</li>
<li>Give credit to hypervolume package for the plot.Hypervolumelist function</li>
</ul>
<p>We can visualize the overlap of the different hypervolumes using the function <code><a href="../reference/Ostats_multivariate_plot.html">Ostats_multivariate_plot()</a></code>. This function returns a list of plot objects, one for each community. Each plot displays an upper triangular matrix of panels, one for each pair of traits, with the cross-sections of the hypervolumes in those two dimensions, as well as the raw data points.</p>
<p>For example, we can plot the overlap of the hypervolumes in 4-dimensional space formed by the individual traits of the pitcher plants at each site. Notice that we don’t use the scaled traits for plotting; instead we use the actual ratios so that the axes are interpretable.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/Ostats_multivariate_plot.html">Ostats_multivariate_plot</a></span><span class="op">(</span>plots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">pitcher_trait_matrix</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                         sp <span class="op">=</span> <span class="va">pitcher_sites</span>,
                         traits <span class="op">=</span> <span class="va">pitcher_trait_matrix</span>,
                         overlap_dat <span class="op">=</span> <span class="va">pitcher_multivariate</span>,
                         plot_points <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
<p><img src="Ostats-multivariate_files/figure-html/default%20plot-1.png" width="864"></p>
<p>We can customize the plot by supplying a color palette to the <code>colorvalues</code> argument (the default is a colorblind-friendly palette imported from <a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html">viridis</a>), and add additional spacing around the hypervolume contours using the <code>axis_buffer_factor</code> argument. The default value of this argument is <code>0.25</code>, or 25% of the range of the data in all directions. In some cases adding additional spacing may be necessary because the contours may extend farther than that. Finally, we can suppress plotting the raw data and only plot the contours using <code>plot_points = FALSE</code>.</p>
<p>FIXME: in the actual function we should include argument to buffer the plot itself, not just the contour estimation.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/Ostats_multivariate_plot.html">Ostats_multivariate_plot</a></span><span class="op">(</span>plots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">pitcher_trait_matrix</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                         sp <span class="op">=</span> <span class="va">pitcher_sites</span>,
                         traits <span class="op">=</span> <span class="va">pitcher_trait_matrix</span>,
                         overlap_dat <span class="op">=</span> <span class="va">pitcher_multivariate</span>,
                         colorvalues <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">sites</span><span class="op">)</span><span class="op">)</span>,
                         axis_buffer_factor <span class="op">=</span> <span class="fl">0.5</span>,
                         plot_points <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
<p><img src="Ostats-multivariate_files/figure-html/custom%20plot-1.png" width="864"></p>
</div>
<div id="some-practical-notes" class="section level1">
<h1 class="hasAnchor">
<a href="#some-practical-notes" class="anchor"></a>Some practical notes</h1>
<ul>
<li>Warning that it’s important to make sure there aren’t a lot of correlated traits in your dataset or you will end up with spurious hypervolumes</li>
<li>Absolute amount of overlap can’t be compared among hypervolumes with different dimensionality, so it’s especially important to run null models</li>
<li>Biologically, it’s been shown that the multi-trait stuff does not contribute that much to what we can infer. This may not be worth discussing in the vignette, but should be discussed in the paper.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Quentin D. Read, Arya Yue, Isadora E. Fluck, Benjamin Baiser, John M. Grady, Phoebe L. Zarnetske, Sydne Record.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
