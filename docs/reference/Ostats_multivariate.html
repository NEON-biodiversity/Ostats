<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate multivariate O-statistics — Ostats_multivariate • Ostats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/darkly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate multivariate O-statistics — Ostats_multivariate"><meta property="og:description" content="This function calculates a single O-statistic across multiple traits
by estimating hypervolumes for each species in multivariate trait space that
contain the trait values for all the individuals in each species. It uses a
stochastic estimation procedure implemented in the R package hypervolume. The
community-level O-statistics estimated from the hypervolume overlaps can be
evaluated against a null model."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Ostats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Ostats-introduction.html">O-stats: pairwise community-level niche overlap statistics</a>
    </li>
    <li>
      <a href="../articles/Ostats-multivariate.html">Multivariate O-statistics</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/NEON-biodiversity/Ostats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate multivariate O-statistics</h1>
    <small class="dont-index">Source: <a href="https://github.com/NEON-biodiversity/Ostats/blob/HEAD/R/Ostats_multivariate.R" class="external-link"><code>R/Ostats_multivariate.R</code></a></small>
    <div class="hidden name"><code>Ostats_multivariate.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function calculates a single O-statistic across multiple traits
by estimating hypervolumes for each species in multivariate trait space that
contain the trait values for all the individuals in each species. It uses a
stochastic estimation procedure implemented in the R package hypervolume. The
community-level O-statistics estimated from the hypervolume overlaps can be
evaluated against a null model.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Ostats_multivariate</span><span class="op">(</span></span>
<span>  <span class="va">traits</span>,</span>
<span>  <span class="va">plots</span>,</span>
<span>  <span class="va">sp</span>,</span>
<span>  output <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>  weight_type <span class="op">=</span> <span class="st">"hmean"</span>,</span>
<span>  run_null_model <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  nperm <span class="op">=</span> <span class="fl">99</span>,</span>
<span>  nullqs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>  shuffle_weights <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  swap_means <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  random_seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hypervolume_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  hypervolume_set_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>traits</dt>
<dd><p>matrix of trait measurements. The number of rows in the matrix
is the number of individuals,
and the number of columns of the matrix is the number of traits.</p></dd>


<dt>plots</dt>
<dd><p>a factor with length equal to nrow(traits) that indicates the
community each individual belongs to.</p></dd>


<dt>sp</dt>
<dd><p>a factor with length equal to nrow(traits) that indicates the taxon
of each individual.</p></dd>


<dt>output</dt>
<dd><p>specifies whether median or mean is calculated.</p></dd>


<dt>weight_type</dt>
<dd><p>specifies weights to be used to calculate the median or mean.</p></dd>


<dt>run_null_model</dt>
<dd><p>whether to run a null model (if <code>TRUE</code>) and evaluate the
O-statistics against it, or simply return the raw O-statistics (if <code>FALSE</code>).
Defaults to <code>TRUE</code>.</p></dd>


<dt>nperm</dt>
<dd><p>the number of null model permutations to generate. Defaults to 99.</p></dd>


<dt>nullqs</dt>
<dd><p>numeric vector of probabilities with values in [0,1] to set
effect size quantiles. Defaults to <code>c(0.025, 0.975)</code>.</p></dd>


<dt>shuffle_weights</dt>
<dd><p>If TRUE, shuffle weights given to pairwise overlaps
within a community when generating null models.</p></dd>


<dt>swap_means</dt>
<dd><p>If TRUE, swap means of body sizes within a community when
generating null models.</p></dd>


<dt>random_seed</dt>
<dd><p>User may supply a random seed to enable reproducibility
of null model output. A warning is issued, and a random seed is generated
based on the local time, if the user does not supply a seed.</p></dd>


<dt>hypervolume_args</dt>
<dd><p>additional arguments to pass to <code><a href="https://rdrr.io/pkg/hypervolume/man/hypervolume.html" class="external-link">hypervolume</a></code>,
such as <code>method</code>. If none are provided, default values are used.
By default, <code>method = "gaussian"</code>.</p></dd>


<dt>hypervolume_set_args</dt>
<dd><p>additional arguments to pass to <code><a href="https://rdrr.io/pkg/hypervolume/man/hypervolume_set.html" class="external-link">hypervolume_set</a></code>,
such as <code>num.points.max</code>. If none are provided, default values are used.</p></dd>


<dt>verbose</dt>
<dd><p>If <code>TRUE</code>, progress messages are displayed. Defaults to <code>FALSE</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The function returns a list containing four objects:</p>
<dl><dt>overlaps_norm</dt>
<dd><p>a matrix showing the O-statistic for each community,
  with the area under all density functions normalized to 1.</p></dd>

<dt>overlaps_unnorm</dt>
<dd><p>a matrix showing O-stats calculated with the area under all density
  functions proportional to the number of observations in that group.</p></dd>

<dt>overlaps_norm_ses</dt>
<dd><p>List of matrices of effect size statistics against a null model
  with the area under all density functions normalized to 1. <code>ses</code> contains the
  effect sizes (z-scores), <code>ses_lower</code> contains the effect size lower critical values
  for significance at the level determined by <code>nullqs</code>, and <code>ses_upper</code>
  contains the upper critical values. <code>raw_lower</code> and <code>raw_upper</code> are
  the critical values in raw units ranging from 0 to 1.</p></dd>

<dt>overlaps_unnorm_ses</dt>
<dd><p>List of matrices of effect size statistics against a null model
  with the area under all density functions proportional to the number
  of observations in that group. Elements are as in <code>overlaps_norm_ses</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function calculates multivariate O-statistics and optionally evaluates them
  against a local null model. By default, it calculates the median of pairwise
  hypervolume overlaps, weighted by harmonic mean of species abundaces of the species
  pairs in each community. Two results are produced, one normalizing the area
  under all density functions to 1, the other making the area under all density
  functions proportional to the number of observations in that group.</p>
<p>Functions from the R package hypervolume by Blonder and colleagues (Blonder 2018) are
  used internally. The function <code><a href="https://rdrr.io/pkg/hypervolume/man/hypervolume.html" class="external-link">hypervolume</a></code> stochastically
  estimates hypervolumes for each species in each community, and the function
  <code><a href="https://rdrr.io/pkg/hypervolume/man/hypervolume_set.html" class="external-link">hypervolume_set</a></code> finds the proportional overlap
  between each pair of hypervolumes.</p>
<p>If <code>run_null_model</code> is <code>TRUE</code>, the O-statistics are evaluated relative
  to a null model. When both <code>shuffle_weights</code> and <code>swap_means</code> are <code>FALSE</code>,
  null communities are generated by randomly assigning a taxon that is present in the community to
  each individual. If <code>shuffle_weights</code> is <code>TRUE</code>, species abundances
  are also randomly assigned to each species to weight the O-statistic for each
  null community. If <code>swap_means</code> is <code>TRUE</code>, instead of sampling individuals
  randomly, species means are sampled randomly among species, keeping the deviation
  of each individual from its species mean the same. After the null communities
  are generated, O-stats are calculated for each null community to compare with
  the observed O-stat.</p>
<p>Effect size statistics are calculated by z-transforming the O-statistics
  using the mean and standard deviation of the null distribution.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Blonder, B. Hypervolume concepts in niche- and trait-based ecology.
  Ecography 41, 1441–1455 (2018). https://doi.org/10.1111/ecog.03187</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="Ostats.html">Ostats</a></code> for univariate data.</p>
<p><code><a href="Ostats_multivariate_plot.html">Ostats_multivariate_plot</a></code> for plotting multivariate trait overlap in
each community.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># overlap statistic between populations of pitcher plants at two different sites</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Select two sites and three dimensions and scale data</span></span></span>
<span class="r-in"><span><span class="va">site_index</span> <span class="op">&lt;-</span> <span class="va">pitcher_traits</span><span class="op">[</span>, <span class="st">'site_id'</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'FLK'</span>, <span class="st">'MYR'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">pitcher_traits</span><span class="op">[</span><span class="va">site_index</span>,</span></span>
<span class="r-in"><span>                               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'rosette_diameter_1'</span>, <span class="st">'pitcher_width'</span>, <span class="st">'mouth_diameter'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">dat</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Here a low number is used for num.points.max for example purposes</span></span></span>
<span class="r-in"><span><span class="va">Ostats_multi_example</span> <span class="op">&lt;-</span> <span class="fu">Ostats_multivariate</span><span class="op">(</span>traits <span class="op">=</span> <span class="va">dat</span>,</span></span>
<span class="r-in"><span>                                            plots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                            sp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">pitcher_traits</span><span class="op">$</span><span class="va">site_id</span><span class="op">[</span><span class="va">site_index</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                            random_seed <span class="op">=</span> <span class="fl">111</span>,</span></span>
<span class="r-in"><span>                                            run_null_model <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                                            hypervolume_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'box'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                            hypervolume_set_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>num.points.max <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Quentin D. Read, Arya Yue, Isadora E. Fluck, Benjamin Baiser, John M. Grady, Phoebe L. Zarnetske, Sydne Record.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

